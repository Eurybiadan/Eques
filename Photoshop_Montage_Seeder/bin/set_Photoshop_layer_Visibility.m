function [ output_args ] = set_Photoshop_layer_Visibility( booleantext )
% Robert F Cooper 10-21-2014
%   These scripts set the layer visibility.

if strcmp(booleantext,'false')
    script = ['var idHd = charIDToTypeID( "Hd  " );'...
    '        var desc59 = new ActionDescriptor();'...
    '        var idnull = charIDToTypeID( "null" );'...
    '        var list6 = new ActionList();'...
    '            var ref46 = new ActionReference();'...
    '            var idLyr = charIDToTypeID( "Lyr " );'...
    '            var idOrdn = charIDToTypeID( "Ordn" );'...
    '            var idTrgt = charIDToTypeID( "Trgt" );'...
    '            ref46.putEnumerated( idLyr, idOrdn, idTrgt );'...
    '        list6.putReference( ref46 );'...
    '    desc59.putList( idnull, list6 );'...
    'executeAction( idHd, desc59, DialogModes.NO );'];

elseif strcmp(booleantext,'true')
    
    script = [ 'var idShw = charIDToTypeID( "Shw " );'...
    '    var desc60 = new ActionDescriptor();'...
    '    var idnull = charIDToTypeID( "null" );'...
    '        var list7 = new ActionList();'...
    '            var ref47 = new ActionReference();'...
    '            var idLyr = charIDToTypeID( "Lyr " );'...
    '            var idOrdn = charIDToTypeID( "Ordn" );'...
    '            var idTrgt = charIDToTypeID( "Trgt" );'...
    '            ref47.putEnumerated( idLyr, idOrdn, idTrgt );'...
    '        list7.putReference( ref47 );'...
    '    desc60.putList( idnull, list7 );'...
    'executeAction( idShw, desc60, DialogModes.NO );'];

end

psjavascript(script);

end

