function [  ] = createBackground( )
% function [ ] = createBackground( )
% Robert Cooper 05-23-2013
%
%     Copyright (C) 2014  Robert F Cooper
% 
%     This program is free software: you can redistribute it and/or modify
%     it under the terms of the GNU General Public License as published by
%     the Free Software Foundation, either version 3 of the License, or
%     (at your option) any later version.
% 
%     This program is distributed in the hope that it will be useful,
%     but WITHOUT ANY WARRANTY; without even the implied warranty of
%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%     GNU General Public License for more details.
% 
%     You should have received a copy of the GNU General Public License
%     along with this program.  If not, see <http://www.gnu.org/licenses/>.
%
% Requires: Photoshop CS5 Extended, and an active connection to a running
% version of photoshop. Photoshop must be running before MATLAB starts!
%

script = ['var idMk = charIDToTypeID( "Mk  " );'...
'    var desc2 = new ActionDescriptor();'...
'    var idnull = charIDToTypeID( "null" );'...
'        var ref1 = new ActionReference();'...
'        var idLyr = charIDToTypeID( "Lyr " );'...
'        ref1.putClass( idLyr );'...
'    desc2.putReference( idnull, ref1 );'...
'executeAction( idMk, desc2, DialogModes.NO );'...
''...
'var idRset = charIDToTypeID( "Rset" );'...
'    var desc3 = new ActionDescriptor();'...
'    var idnull = charIDToTypeID( "null" );'...
'        var ref2 = new ActionReference();'...
'        var idClr = charIDToTypeID( "Clr " );'...
'        var idClrs = charIDToTypeID( "Clrs" );'...
'        ref2.putProperty( idClr, idClrs );'...
'    desc3.putReference( idnull, ref2 );'...
'executeAction( idRset, desc3, DialogModes.NO );'...
''...
'var idMk = charIDToTypeID( "Mk  " );'...
'    var desc4 = new ActionDescriptor();'...
'    var idnull = charIDToTypeID( "null" );'...
'        var ref3 = new ActionReference();'...
'        var idBckL = charIDToTypeID( "BckL" );'...
'        ref3.putClass( idBckL );'...
'    desc4.putReference( idnull, ref3 );'...
'    var idUsng = charIDToTypeID( "Usng" );'...
'        var ref4 = new ActionReference();'...
'        var idLyr = charIDToTypeID( "Lyr " );'...
'        var idOrdn = charIDToTypeID( "Ordn" );'...
'        var idTrgt = charIDToTypeID( "Trgt" );'...
'        ref4.putEnumerated( idLyr, idOrdn, idTrgt );'...
'    desc4.putReference( idUsng, ref4 );'...
'executeAction( idMk, desc4, DialogModes.NO );'];

psjavascript(script);
