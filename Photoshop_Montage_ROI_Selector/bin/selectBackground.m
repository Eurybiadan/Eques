function [ exists ] = selectBackground( )
% function [ ] = selectBackground( )
% Robert Cooper 05-23-2013
%
%     Copyright (C) 2014  Robert F Cooper
% 
%     This program is free software: you can redistribute it and/or modify
%     it under the terms of the GNU General Public License as published by
%     the Free Software Foundation, either version 3 of the License, or
%     (at your option) any later version.
% 
%     This program is distributed in the hope that it will be useful,
%     but WITHOUT ANY WARRANTY; without even the implied warranty of
%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%     GNU General Public License for more details.
% 
%     You should have received a copy of the GNU General Public License
%     along with this program.  If not, see <http://www.gnu.org/licenses/>.
%
% Requires: Photoshop CS5 Extended, and an active connection to a running
% version of photoshop. Photoshop must be running before MATLAB starts!
%
% This script selects the background of the active photoshop document, returning true. If
% there isn't one, the script returns false.

script = ['function selectBackgroundLayer(){;'...
'        try{;'...
'            var idslct = charIDToTypeID( "slct" );'...
'            var desc13 = new ActionDescriptor();'...
'            var idnull = charIDToTypeID( "null" );'...
'                var ref12 = new ActionReference();'...
'                var idLyr = charIDToTypeID( "Lyr " );'...
'                ref12.putName( idLyr, "Background" );'...
'            desc13.putReference( idnull, ref12 );'...
'            var idMkVs = charIDToTypeID( "MkVs" );'...
'            desc13.putBoolean( idMkVs, false );'...
'        executeAction( idslct, desc13, DialogModes.NO );'...
'        return true;'...
''...
'        }catch(e){;'...
'            return false;'...
'        }'...
'};'...
'function showByName() {'...
'    var desc = new ActionDescriptor();'...
'        var list = new ActionList();'...
'            var ref = new ActionReference();'...
'            ref.putName( charIDToTypeID("Lyr "), "Background" );'...
'        list.putReference( ref );'...
'    desc.putList( charIDToTypeID("null"), list );'...
'    executeAction( charIDToTypeID("Shw "), desc, DialogModes.NO );'...
'};'...
''...
'selectBackgroundLayer();'...
'showByName();'];

exists = psjavascript(script);

